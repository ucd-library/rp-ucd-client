(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{102:function(t,e,n){"use strict";var r=n(2),i=n(34),a=n.n(i);function o(){var t=u(["\n          ",'\n          <hr class="dotted">\n          ']);return o=function(){return t},t}function s(){var t=u(["\n\n<style>\n  :host {\n    display: block;\n  }\n  ",'\n</style>\n<div class="collections works container bg-light top">\n  ','\n  <hr class="mb-0">\n  <div class="body flex">\n    <div class="col-facets mt-3">\n      ','\n    </div>\n    <div class="col-main">\n      <div ?hidden="','" class="flex align-items-center justify-content-center">\n        <div class="loading1">loading</div>\n      </div>\n      <div ?hidden="','" class="flex align-items-center justify-content-center">\n        <rp-alert>Error loading works.</rp-alert>\n      </div>\n      <div class="data" ?hidden="','">\n        ',"\n        ","\n      </div>\n\n    </div>\n  </div>\n\n</div>\n"]);return s=function(){return t},t}function u(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function c(){var t=this;return Object(r.b)(s(),a.a,this._renderBrowseHeader("Works"),this._renderFacets(),"error"==this.dataStatus||"loaded"==this.dataStatus,"loading"==this.dataStatus||"loaded"==this.dataStatus,"loading"==this.dataStatus||"error"==this.dataStatus,this.data.map((function(e){return Object(r.b)(o(),t._renderAssetPreview(e))})),this._renderPagination(this.dataTotal))}var l=n(94);n(89),n(90);function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e,n,r,i,a,o){try{var s=t[a](o),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){p(a,r,i,o,s,"next",t)}function s(t){p(a,r,i,o,s,"throw",t)}o(void 0)}))}}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function y(t,e,n){return e&&d(t.prototype,e),n&&d(t,n),t}function b(t,e){return(b=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function v(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=w(t);if(e){var i=w(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}function g(t,e){return!e||"object"!==f(e)&&"function"!=typeof e?m(t):e}function m(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var O=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&b(t,e)}(a,t);var e,n,r,i=v(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this)).render=c.bind(m(t)),t.AppStateModel.get().then((function(e){return t._onAppStateUpdate(e)})),t}return y(a,null,[{key:"properties",get:function(){return{}}}]),y(a,[{key:"_onAppStateUpdate",value:(r=h(regeneratorRuntime.mark((function t(e){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:requestAnimationFrame((function(){return n.doUpdate(e)}));case 1:case"end":return t.stop()}}),t)}))),function(t){return r.apply(this,arguments)})},{key:"doUpdate",value:(n=h(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.updateComplete;case 2:if(this.visible){t.next=4;break}return t.abrupt("return");case 4:return this._parseUrlQuery(e),t.next=7,Promise.all([this._doMainQuery(),this._getFacets(),this._getAzAgg()]);case 7:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"_getFacets",value:(e=h(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,this.CollectionModel.overview("worksAggs");case 3:if(e=t.sent,this.subFacetStatus=e.state,"loaded"==e.state){t.next=7;break}return t.abrupt("return");case 7:this.subFacets=this.CollectionModel._getSubFacets("works",e.payload,this.currentQuery);case 8:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),a}(l.a);customElements.define("rp-page-works",O)},94:function(t,e,n){"use strict";n.d(e,"a",(function(){return M}));var r=n(2);n(103),n(95),n(104),n(100),n(90),n(105);function i(){var t=y(['\n    <rp-pagination max-page="','"\n                   current-page="','"\n                   @changed-page="','"\n                   class="mt-3"\n    ></rp-pagination>\n    ']);return i=function(){return t},t}function a(){var t=y([""]);return a=function(){return t},t}function o(){var t=y([""]);return o=function(){return t},t}function s(){var t=y(['\n      <rp-organization-preview .data="','" class="my-3"></rp-organization-preview>\n      ']);return s=function(){return t},t}function u(){var t=y(['\n      <rp-work-preview .data="','" class="my-3"></rp-work-preview>\n      ']);return u=function(){return t},t}function c(){var t=y(['\n      <rp-person-preview\n        name="','"\n        href="','"\n        title="','"\n        text-width="','"\n        class="my-3">\n      </rp-person-preview>\n      ']);return c=function(){return t},t}function l(){var t=y(["\n    <rp-link-list \n      has-header-link\n      .links='","'\n      current-link='","'\n      >\n    </rp-link-list>\n    "]);return l=function(){return t},t}function f(){var t=y([""]);return f=function(){return t},t}function p(){var t=y([""]);return p=function(){return t},t}function h(){var t=y(['\n        <rp-a-z selected-letter="','"\n                .disabledLetters="','"\n                @changed-letter=',">\n        </rp-a-z>\n      "]);return h=function(){return t},t}function d(){var t=y(['\n    <div class="header flex align-items-center">\n      <div class="col-facets">\n        <h1>','</h1>\n      </div>\n      <div class="col-main">\n      ',"\n\n      </div>\n    </div>\n    "]);return d=function(){return t},t}function y(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function b(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?b(Object(n),!0).forEach((function(e){g(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=k(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function w(t){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function O(t,e,n,r,i,a,o){try{var s=t[a](o),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function S(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){O(a,r,i,o,s,"next",t)}function s(t){O(a,r,i,o,s,"throw",t)}o(void 0)}))}}function F(t){return function(t){if(Array.isArray(t))return j(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||k(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(t,e){if(t){if("string"==typeof t)return j(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(t,e):void 0}}function j(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _(t,e,n){return(_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=R(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function P(t,e,n){return e&&x(t.prototype,e),n&&x(t,n),t}function z(t,e){return(z=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function C(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=R(t);if(e){var i=R(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return A(this,n)}}function A(t,e){return!e||"object"!==w(e)&&"function"!=typeof e?Q(t):e}function Q(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function R(t){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var M=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&z(t,e)}(g,t);var e,n,y,b=C(g);function g(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g),(t=b.call(this))._injectModel("CollectionModel","AppStateModel"),t.azOptions=new Set(["all"].concat(F("abcdefghijklmnopqrstuvwxyz"))),t.hasPagination=!1,t.visible=!1,t.urlQuery={},t.jsonldContext=APP_CONFIG.data.jsonldContext,t._resetQueryProperties(),t.setPeopleWidth(window.innerWidth),t._handleResize=t._handleResize.bind(Q(t)),t}return P(g,null,[{key:"properties",get:function(){return{hasAz:{type:Boolean},hasPagination:{type:Boolean},azSelected:{type:String},azStatus:{type:String},azDisabled:{type:Array},azOptions:{type:Set},urlQuery:{type:Object},jsonldContext:{type:String},peopleWidth:{type:Number},visible:{type:Boolean},currentQuery:{type:Object},mainFacet:{type:String},mainFacets:{type:Array},pgPer:{type:Number},pgCurrent:{type:Number},textQuery:{type:String},dataFilters:{type:Array},data:{type:Array},dataStatus:{type:String},dataTotal:{type:Number},mainFacetIndex:{type:Number},subFacet:{type:String},subFacetIndex:{type:Number},subFacetStatus:{type:String}}}}]),P(g,[{key:"_resetQueryProperties",value:function(){this.data=[],this.dataStatus="loading",this.dataTotal=0,this.currentQuery={},this.dataFilters=[],this.pgPer=8,this.pgCurrent=1,this.mainFacet="none",this.mainFacets=[],this.mainFacetIndex=0,this.subFacet="none",this.subFacetIndex=0,this.subFacets=[],this.subFacetStatus="loading",this.textQuery="",this.hasAz=!1,this.azSelected="All",this.azDisabled=[],this.azStatus="loading"}},{key:"updated",value:function(t){this.doUpdated(t)}},{key:"doUpdated",value:function(t){var e=this;t.has("visible")&&this.visible&&requestAnimationFrame((function(){return e._handleResize()}))}},{key:"connectedCallback",value:function(){_(R(g.prototype),"connectedCallback",this).call(this),window.addEventListener("resize",this._handleResize)}},{key:"disconnectedCallback",value:function(){window.removeEventListener("resize",this._handleResize),_(R(g.prototype),"disconnectedCallback",this).call(this)}},{key:"_doMainQuery",value:(y=S(regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.currentQuery,t.next=3,this.CollectionModel.query(e);case 3:if(n=t.sent,r=!1,this.textQuery&&"none"==this.mainFacet&&"none"==this.subFacet&&(this.subFacetStatus=n.state,r=!0),this.dataStatus=n.state,"loaded"==n.state){t.next=9;break}return t.abrupt("return");case 9:"object"===w(n.payload.total)?this.dataTotal=0:this.dataTotal=n.payload.total,r?(this.CollectionModel.store.setSearchAggsLoaded(this.textQuery,n.payload),this.mainFacets=this.CollectionModel._getMainFacets(n.payload,this.currentQuery),this.subFacets=this.CollectionModel._getSubFacets(this.mainFacet,n.payload,this.currentQuery)):this.hasAz=!0,this.data=n.payload.results,console.log("main query result:",n);case 13:case"end":return t.stop()}}),t,this)}))),function(){return y.apply(this,arguments)})},{key:"_getSearchAggs",value:(n=S(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.textQuery){t.next=2;break}return t.abrupt("return");case 2:if("none"!=this.mainFacet||"none"!=this.subFacet){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,this.CollectionModel.searchAggQuery(this.textQuery,this.mainFacet);case 6:if(e=t.sent,this.subFacetStatus=e.state,"loaded"==e.state){t.next=10;break}return t.abrupt("return");case 10:this.mainFacets=this.CollectionModel._getMainFacets(e.payload,this.currentQuery),this.subFacets=this.CollectionModel._getSubFacets(this.mainFacet,e.payload,this.currentQuery);case 12:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"_getAzAgg",value:(e=S(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.CollectionModel.azAggQuery(this.currentQuery.mainFacet,this.currentQuery.subFacet);case 2:if(e=t.sent,this.azStatus=e.state,"loaded"==e.state){t.next=6;break}return t.abrupt("return");case 6:(n=this.CollectionModel.getAzBaseFilter(this.currentQuery.mainFacet))&&n.key?this.azDisabled=F(this._setDifference(this.azOptions,Object.keys(e.payload.aggregations.facets[n.key]))).filter((function(t){return"all"!=t})):this.azStatus="error",console.log("az for ".concat(this.currentQuery.mainFacet,", ").concat(this.currentQuery.subFacet),e);case 9:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"_parseUrlQuery",value:function(t){t||(t=this.AppStateModel.store.data);var e=t.location.path,n=t.location.query;if(this._resetQueryProperties(),!(e.length<1)){var r="";r="search"==e[0]&&e.length>1?e[1].toLowerCase():e[0].toLowerCase();var i,a=m(this.CollectionModel.mainFacets);try{for(a.s();!(i=a.n()).done;){var o=i.value;if(r==o.id.toLowerCase()){this.mainFacet=r,this.dataFilters.push(o.baseFilter);break}}}catch(t){a.e(t)}finally{a.f()}var s="";if("search"==e[0]&&e.length>2?s=e[2].toLowerCase():"search"!=e[0]&&e.length>1&&(s=e[1].toLowerCase()),this.CollectionModel.subFacets[this.mainFacet]){var u,c=1,l=m(this.CollectionModel.subFacets[this.mainFacet]);try{for(l.s();!(u=l.n()).done;){var f=u.value;if(f.id==s){this.subFacet=s,this.subFacetIndex=c,this.dataFilters.push(f.baseFilter);break}c+=1}}catch(t){l.e(t)}finally{l.f()}}for(var p in n)"s"==p?this.textQuery=n.s:"filters"==p||("page"!=p||isNaN(n[p])?"az"==p&&this.azOptions.has(n[p])&&(this.azSelected=n[p]):this.pgCurrent=n[p]);this.currentQuery=this._constructQuery(),console.log("element query:",this.currentQuery)}}},{key:"_constructQuery",value:function(){var t={};return this.textQuery&&(t.textQuery=this.textQuery),this.pgCurrent&&(t.pgCurrent=this.pgCurrent),this.pgPer&&(t.pgPer=this.pgPer),this.azSelected&&(t.azSelected=this.azSelected),this.dataFilters&&(t.filters=this.dataFilters),this.mainFacet&&"none"!=this.mainFacet&&(t.mainFacet=this.mainFacet),this.subFacet&&"none"!=this.subFacet&&(t.subFacet=this.subFacet),t}},{key:"_handleResize",value:function(){if(this.visible){var t=window.innerWidth;this.setPeopleWidth(t)}}},{key:"setPeopleWidth",value:function(t){var e;e=.7*(t-30)-82-40,this.peopleWidth=Math.floor(e)}},{key:"_onUserAction",value:function(t){if(t){var e="",n=v({},this.currentQuery);"pagination"==t&&this.hasPagination?(n.pgCurrent=arguments.length<=1?void 0:arguments[1],e=this.CollectionModel.constructUrl(n)):"az"==t&&(n.azSelected=arguments.length<=1?void 0:arguments[1],e=this.CollectionModel.constructUrl(n,["page"])),e&&this.AppStateModel.setLocation(e)}}},{key:"_setDifference",value:function(t,e){var n,r=new Set(t),i=m(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;r.delete(a)}}catch(t){i.e(t)}finally{i.f()}return r}},{key:"_getAssetType",value:function(t){if(t["@type"]&&("string"==typeof t["@type"]&&(t["@type"]=[t["@type"]]),Array.isArray(t["@type"])))return t["@type"].includes(this.jsonldContext+":person")?"person":t["@type"].includes(this.jsonldContext+":publication")?"work":t["@type"].includes(this.jsonldContext+":organization")?"organization":void 0}},{key:"_urlEncode",value:function(t){var e=[];for(var n in t)if(t.hasOwnProperty(n)){if("offset"==n&&0==t[n])continue;if("filters"==n&&0==Object.keys(t[n]).length)continue;if("limit"==n)continue;e.push(encodeURIComponent(n)+"="+encodeURIComponent(JSON.stringify(t[n])))}return e.length?"?"+e.join("&"):""}},{key:"_renderBrowseHeader",value:function(t,e){var n=this;return this.hasAz=!0,e&&(this.azSelected=e),Object(r.b)(d(),t,this.hasAz?Object(r.b)(h(),this.azSelected,this.azDisabled,(function(t){return n._onUserAction("az",t.target.selectedLetter)})):Object(r.b)(p()))}},{key:"_renderFacets",value:function(){return this.subFacets?Object(r.b)(l(),this.subFacets,this.subFacetIndex):Object(r.b)(f())}},{key:"_renderAssetPreview",value:function(t){var e=this._getAssetType(t);if("person"==e){var n=this.CollectionModel._formatPerson(t);return Object(r.b)(c(),n.name,"/individual/"+n.id,n.title,this.peopleWidth)}return"work"==e?Object(r.b)(u(),t):"organization"==e?Object(r.b)(s(),t):Object(r.b)(o())}},{key:"_renderPagination",value:function(t){var e=this;if(!t)return Object(r.b)(a());this.hasPagination=!0;var n=Math.ceil(t/this.pgPer);return Object(r.b)(i(),n,this.pgCurrent,(function(t){return e._onUserAction("pagination",t.target.currentPage)}))}}]),g}(Mixin(r.a).with(LitCorkUtils));customElements.define("rp-utils-collection",M)}}]);