(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{96:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return F}));var r=n(2),i=n(41),o=n.n(i);function a(){var t=u(['\n          <rp-person-preview\n            name="','"\n            href="','"\n            title="','"\n            text-width="','"\n            class="my-3">\n          </rp-person-preview>\n          <hr class="dotted">\n          ']);return a=function(){return t},t}function c(){var t=u(["\n\n<style>\n  :host {\n    display: block;\n  }\n  ",'\n</style>\n<div class="collections container bg-light top">\n  <hr class="mb-0">\n  <div class="body flex">\n    <div class="col-facets mt-3">\n      ','\n    </div>\n    <div class="col-main">\n      <div ?hidden="','" class="flex align-items-center justify-content-center">\n        <div class="loading1">loading</div>\n      </div>\n      <div ?hidden="','" class="flex align-items-center justify-content-center">\n        <rp-alert>Error loading people.</rp-alert>\n      </div>\n      <div class="data" ?hidden="','">\n        ',"\n        ","\n      </div>\n\n    </div>\n  </div>\n\n</div>\n"]);return c=function(){return t},t}function u(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function s(){var t=this;return Object(r.b)(c(),o.a,this._renderFacets(this.facets),"error"==this.dataStatus||"loaded"==this.dataStatus,"loading"==this.dataStatus||"loaded"==this.dataStatus,"loading"==this.dataStatus||"error"==this.dataStatus,this.CollectionModel._formatPeople(this.data).map((function(e){return Object(r.b)(a(),e.name,"/individual/"+e.id,e.title,t.peopleWidth)})),this._renderPagination(this.dataTotal))}n(92),n(88),n(93);function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(){var t=v(['\n    <rp-pagination max-page="','"\n                   current-page="','"\n                   @changed-page="','"\n                   class="mt-3"\n    ></rp-pagination>\n    ']);return f=function(){return t},t}function p(){var t=v([""]);return p=function(){return t},t}function d(){var t=v(["\n      <rp-link-list has-header-link\n                    links='","'\n                    current-link='","'\n                    @changed-link=\"",'">\n      </rp-link-list>\n      ']);return d=function(){return t},t}function y(){var t=v(["","\n    "]);return y=function(){return t},t}function h(){var t=v([""]);return h=function(){return t},t}function b(){var t=v(['\n    <div class="header flex align-items-center">\n      <div class="col-facets">\n        <h1>','</h1>\n      </div>\n      <div class="col-main">\n        <rp-a-z selected-letter="','"\n                disabled-letters="','"\n                @changed-letter=',"></rp-a-z>\n      </div>\n    </div>\n    "]);return b=function(){return t},t}function v(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function g(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?g(Object(n),!0).forEach((function(e){m(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function j(t,e,n){return e&&w(t.prototype,e),n&&w(t,n),t}function P(t,e){return(P=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function S(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=k(t);if(e){var i=k(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _(this,n)}}function _(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var R=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&P(t,e)}(n,t);var e=S(n);function n(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(t=e.call(this)).hasAz=!1,t.hasPagination=!1,t.azSelected="All",t.azDisabled=[],t.pgPer=8,t.pgCurrent=1,t.urlQuery={},t}return j(n,null,[{key:"properties",get:function(){return{hasAz:{type:Boolean},hasPagination:{type:Boolean},azSelected:{type:String},azDisabled:{type:Array},pgPer:{type:parseInt},pgCurrent:{type:parseInt},urlQuery:{type:Object}}}}]),j(n,[{key:"_onUserAction",value:function(t){if(t){var e=O({},this.urlQuery);if(e.filters||(e.filters={}),console.log("User action:",t),"az"!=t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if("pagination"==t&&this.hasPagination&&(this.pgCurrent=r[0],e.offset=this.pgCurrent*this.urlQuery.limit-this.urlQuery.limit),t.startsWith("facet_")){if(r[0].filters)e.filters=O(O({},e.filters),r[0].filters);else{var o=t.slice("facet_".length);e.filters[o]&&delete e.filters[o]}e.offset=0}var a="";this.AppStateModel&&(a="/"+this.AppStateModel.store.data.location.path.join("/")),a+=this._urlEncode(e),this.AppStateModel.setLocation(a)}}}},{key:"_renderBrowseHeader",value:function(t,e){var n=this;return this.hasAz=!0,e&&(this.azSelected=e),Object(r.b)(b(),t,this.azSelected,JSON.stringify(this.azDisabled),(function(t){return n._onUserAction("az")}))}},{key:"_renderFacets",value:function(t){var e=this;return t?Object(r.b)(y(),t.map((function(t){return Object(r.b)(d(),JSON.stringify(t.values),t.activeIndex,(function(n){return e._onUserAction("facet_"+t.id,n.target.links[n.target.currentLink])}))}))):Object(r.b)(h())}},{key:"_renderPagination",value:function(t){var e=this;if(!t||!this.urlQuery)return Object(r.b)(p());this.hasPagination=!0;var n=Math.ceil(t/this.urlQuery.limit);return this.pgCurrent=Math.ceil((this.urlQuery.offset+1)/this.urlQuery.limit),Object(r.b)(f(),n,this.pgCurrent,(function(t){return e._onUserAction("pagination",t.target.currentPage)}))}},{key:"_parseUrlQuery",value:function(){var t={};if(this.AppStateModel){var e=this.AppStateModel.store.data.location.query;for(var n in e)t[n]=JSON.parse(e[n])}return t.limit||(t.limit=this.pgPer),t.offset||(t.offset=0),this.urlQuery=t,t}},{key:"_urlEncode",value:function(t){var e=[];for(var n in t)if(t.hasOwnProperty(n)){if("offset"==n&&0==t[n])continue;if("filters"==n&&0==Object.keys(t[n]).length)continue;if("limit"==n)continue;e.push(encodeURIComponent(n)+"="+encodeURIComponent(JSON.stringify(t[n])))}return e.length?"?"+e.join("&"):""}}]),n}(r.a);customElements.define("rp-utils-collection",R);n(83),n(87);function A(t){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function z(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){C(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function C(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function M(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){D(o,r,i,a,c,"next",t)}function c(t){D(o,r,i,a,c,"throw",t)}a(void 0)}))}}function E(t,e,n){return(E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=T(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function U(t,e,n){return e&&Q(t.prototype,e),n&&Q(t,n),t}function W(t,e){return(W=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function I(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=T(t);if(e){var i=T(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return J(this,n)}}function J(t,e){return!e||"object"!==A(e)&&"function"!=typeof e?N(t):e}function N(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function T(t){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var F=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&W(t,e)}(o,t);var e,n,r,i=I(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this)).render=s.bind(N(t)),t._injectModel("CollectionModel","AppStateModel"),t.filtersDefault={"@type":{type:"keyword",op:"and",value:[APP_CONFIG.data.jsonldContext+":person"]}},t.sortDefault=[{label:"asc"}],t.dataStatus="loading",t.dataTotal=0,t.setPeopleWidth(window.innerWidth),t.data=[],t.facetStatus="loading",t.facets=[],t.AppStateModel.get().then((function(e){return t._onAppStateUpdate(e)})),t._handleResize=t._handleResize.bind(N(t)),t}return U(o,null,[{key:"properties",get:function(){return{filtersDefault:{type:Object},sortDefault:{type:Array},dataStatus:{type:String},data:{type:Array},dataMax:{type:parseInt},peopleWidth:{type:parseInt},visible:{type:Boolean},facetStatus:{type:String},facets:{type:Array}}}}]),U(o,[{key:"updated",value:function(t){var e=this;t.has("visible")&&this.visible&&requestAnimationFrame((function(){return e._handleResize()}))}},{key:"connectedCallback",value:function(){E(T(o.prototype),"connectedCallback",this).call(this),window.addEventListener("resize",this._handleResize)}},{key:"disconnectedCallback",value:function(){window.removeEventListener("resize",this._handleResize),E(T(o.prototype),"disconnectedCallback",this).call(this)}},{key:"_onAppStateUpdate",value:(r=M(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=z({},this._parseUrlQuery()),t.next=3,Promise.all([this._doQuery(n),this._getFacets(n)]);case 3:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"_doQuery",value:(n=M(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.filters||(e.filters=this.filtersDefault),e.sort||(e.sort=this.sortDefault),t.next=4,this.CollectionModel.query(e);case 4:if(n=t.sent,this.dataStatus=n.state,"loaded"==n.state){t.next=8;break}return t.abrupt("return");case 8:this.dataTotal=n.payload.total,this.data=n.payload.results,console.log(n),console.log(this.data);case 12:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"_getFacets",value:(e=M(regeneratorRuntime.mark((function t(e){var n,r,i,o,a,c,u,s,l,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.filters,t.next=3,this.CollectionModel.overview("peopleAggs");case 3:if(r=t.sent,this.facetStatus=r.state,"loaded"==r.state){t.next=7;break}return t.abrupt("return");case 7:for(s in this.facets=[],i="",o=0,a=[{label:"All",count:r.payload.total,text:"All (".concat(r.payload.total,")")}],c=r.payload.aggregations.facets["@type"],u=1,n&&n["@type"]&&(i=JSON.stringify(n["@type"].value)),c)s.startsWith("vivo:")&&(l=this.CollectionModel._formatAgg(s,"vivo:"),f={type:"keyword",op:"and",value:[s]},i==JSON.stringify(f.value)&&(o=u),a.push({label:l,count:c[s],text:"".concat(l," (").concat(c[s],")"),filters:{"@type":f},name:s}),u++);this.facets.push({values:a,activeIndex:o,id:"@type"}),console.log(this.facets);case 19:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"_handleResize",value:function(){if(this.visible){var t=window.innerWidth;this.setPeopleWidth(t)}}},{key:"setPeopleWidth",value:function(t){var e;e=.7*(t-30)-82-40,this.peopleWidth=Math.floor(e)}}]),o}(Mixin(R).with(LitCorkUtils));customElements.define("rp-page-people",F)}}]);